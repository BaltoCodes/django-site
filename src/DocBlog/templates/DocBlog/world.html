{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Welcome Page</title>
    <script async src="https://unpkg.com/es-module-shims@1.6.3/dist/es-module-shims.js"></script>

    <style>
        body {
            margin: 0;
            padding: 0;
            background-color: #000000;
        }

        nav {
            background-color: #333;
            overflow: hidden;
        }

        nav ul {
            list-style-type: none;
            margin: 0;
            padding: 0;
        }

        nav li {
            float: left;
        }

        nav li a {
            display: block;
            color: white;
            text-align: center;
            padding: 14px 16px;
            text-decoration: none;
        }

        nav li a:hover {
            background-color: #111;
        }
        .title {
            font-size: 12px;
            color: #dee2e6;
            font-family: "Arial", sans-serif;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
            text-align:center;
        }

        .earth{


            position: absolute;
            top: 10px;
        }
    </style>
    <script type="importmap">
      {
        "imports": {
          "three": "https://unpkg.com/three@v0.149.0/build/three.module.js",
          "three/addons/": "https://unpkg.com/three@v0.149.0/examples/jsm/"
        }
      }
    </script>
</head>
<body> 

    <div class="navigator">
        <nav>
            <ul>
                <li><a href="/accueil/">Accueil</a></li>
                <li><a href="/get-message/">ChatBot With Me</a></li>
                <li><a href="/graph/">BTC Graph</a></li>
                <li><a href="/prix/">Prix</a></li>
                <!-- Ajoutez d'autres liens de navigation ici -->
            </ul>
        </nav>
    </div>
    <div class="title" >
        <h1>The world is yours</h1>
        <h2>Big Balto Cash</h2>

    </div>
     <div class="earth">     
        <script type="module" >
            
            import { TextGeometry } from 'three/addons/geometries/TextGeometry.js';
            import { FontLoader } from 'three/addons/loaders/FontLoader.js';
    
            import * as THREE from 'three';
            
            const scene = new THREE.Scene();
            const camera = new THREE.PerspectiveCamera( 75, window.innerWidth /
            window.innerHeight, 0.1, 1000 );


            const renderer = new THREE.WebGLRenderer();
            renderer.setSize( window.innerWidth, window.innerHeight );
            document.body.appendChild( renderer.domElement );

            const geometry = new THREE.SphereGeometry(2, 32, 32);
            const geometryMoon = new THREE.SphereGeometry(0.005, 1, 1);


            const textureLoader = new THREE.TextureLoader();
            const texture = textureLoader.load("{% static 'css/textures/earth.jpg' %}");

            const material = new THREE.MeshBasicMaterial({ map: texture });
            
            const textureMoon = textureLoader.load("{% static 'css/textures/moon.jpg' %}");
            const materialMoon = new THREE.MeshBasicMaterial({map:textureMoon})

            const moon = new THREE.Mesh(geometry, materialMoon);
            const earth = new THREE.Mesh(geometry, material);

            const ambientLight = new THREE.AmbientLight(0xffffff, 0.3);
            scene.add(ambientLight);
            
            scene.add(earth);
            scene.add(moon);




        


            const colors = [
        new THREE.Color(0x9F9494), // Red
        new THREE.Color(0x5E5454), // Green
        new THREE.Color(0x9F9D9D), // Blue
        new THREE.Color(0xffff00), // Yellow
        new THREE.Color(0xff00ff), // Magenta
        new THREE.Color(0x00ffff), // Cyan
      ];


           
            
            //textMesh.position.set(2, 3, 0); // Changer les valeurs x, y, z pour ajuster la position du texte sur la Terre
            
            let backgroundColor = new THREE.Color(0x000000); // Black

            const loader = new FontLoader();
            loader.load('https://threejs.org/examples/fonts/helvetiker_regular.typeface.json', function (font) {

            const matLite = new THREE.MeshPhongMaterial({
                color: 0xE1B32F,
                transparent: true,
                opacity: 0.8,
                side: THREE.DoubleSide
            });

            const message = "The world is yours";
            const message_second ="The world is still yours";

            const shapes = font.generateShapes(message, 0.25);

            // Créez une extrusion pour le texte incurvé en 3D
            const extrudeSettings = {
                depth: 0.1, // épaisseur du texte
                bevelEnabled: true,
                bevelThickness: 0.03,
                bevelSize: 0.02,
                bevelSegments: 5
            };

            const geometry = new THREE.ExtrudeGeometry(shapes, extrudeSettings);
            geometry.computeBoundingBox();

            // Centrez le texte
            const xMid = - 0.5 * (geometry.boundingBox.max.x - geometry.boundingBox.min.x);
            geometry.translate(xMid, 0, 0);

            const text = new THREE.Mesh(geometry, matLite);
            text.position.y = 1.5;
            text.position.z=1.5;
            text.rotation.x=-0.4;
            earth.add(text);




            const geometry_second = new THREE.ShapeGeometry(shapes);
            geometry_second.computeBoundingBox();

            // Courbure de l'axe Y
            const curveAmount = 1.5; // Ajustez la courbure selon vos besoins

            const position = new THREE.Vector3();
            const matrix = new THREE.Matrix4();

            for (let i = 0; i < geometry_second.vertices.length; i++) {
                position.x = geometry_second.vertices[i].x;
                position.y = geometry_second.vertices[i].y;
                position.z = geometry_second.vertices[i].z;

                matrix.makeTranslation(0, position.y, 0);
                matrix.applyAxisAngle(new THREE.Vector3(1, 0, 0), curveAmount * position.x);

                geometry_second.vertices[i].applyMatrix4(matrix);
            };

            const text_two = new THREE.Mesh(geometry_second, matLite);
            
            earth.add(text_two);

            text_two.position.y = 1.5;
            text_two.position.z=-1.5;
            text_two.rotation.x=-0.4;
            });





            // Function to update the background color
            function updateBackgroundColor(targetColor, duration) {
                    const startColor = backgroundColor.clone();
                    let startTime = null;

                    function animateBackground(time) {
                    if (!startTime) startTime = time;
                    const elapsedTime = time - startTime;
                    const progress = Math.min(elapsedTime / duration, 1);

                    // Linear interpolation between startColor and targetColor
                    backgroundColor.copy(startColor).lerp(targetColor, progress);

                    // Set the background color
                    renderer.setClearColor(backgroundColor);

                    if (progress < 1) {
                        requestAnimationFrame(animateBackground);
                    }
                    }

                    requestAnimationFrame(animateBackground);
                }

                // Function to change the background color randomly
            function changeBackgroundColorRandomly() {
                const randomColor = colors[Math.floor(Math.random() * colors.length)];
                updateBackgroundColor(randomColor, 2500);
            }

////Changement de couleur du background
            setInterval(changeBackgroundColorRandomly, 1000);





            const light = new THREE.PointLight(0xffffff, 1, 20);
            scene.add(light);
            light.position.set(0, 0, 0);
            light.intensity = 15;
            light.distance = 5;
            light.decay = 5;
            light.color = new THREE.Color(0xffff00); // Jaune
            //const lightSphere = new THREE.Mesh(
                //new THREE.SphereGeometry(4),
               // new THREE.MeshBasicMaterial({ color: 0xffff00 })
            //);
           // scene.add(lightSphere);
            //lightSphere.position.copy(light.position);




            // Ajouter le texte à la Terre
            //earth.add(textMesh);
            camera.position.z = 6;
            camera.position.y=0;
            earth.position.y=0;
            moon.position.x=-4;
            moon.scale.x= 0.5;
            moon.scale.y= 0.5;
            moon.scale.z= 0.5;


            const centerX = window.innerWidth / 2;
        
            const centerZ = window.innerDepth / 2;
            const semiMajorAxis = 100; // Demi-grand axe
            const semiMinorAxis = 50; // Demi-petit axe
            let angle = 0;

            function animate() {


            requestAnimationFrame( animate );
                earth.rotation.y += 0.007;
                moon.rotation.y +=0.05;

                const moonOrbitRadius = 5;
                const moonOrbitRadiusZ = 2; 
                const moonOrbitRadisuY =1.5; // Rayon de l'orbite de la lune autour de la Terre
                const moonOrbitSpeed = 0.01; // Vitesse orbitale de la lune
                const centerX=0;
                const centerZ=0;
                const centerY=0;
                // Calcule les nouvelles coordonnées de la lune le long de son orbite elliptique
                const moonX = centerX + moonOrbitRadius * Math.cos(angle);
                const moonZ = centerZ + moonOrbitRadiusZ * Math.sin(angle);
                const moonY = centerY + moonOrbitRadisuY *Math.sin(angle);
                // Déplace la lune à sa nouvelle position
                moon.position.set(moonX, moonY, moonZ);

                // Fait tourner la lune sur son axe
                moon.rotation.y += 0.005;

                // Met à jour l'angle pour l'animation de l'orbite de la lune
                angle += moonOrbitSpeed;


                
                
            renderer.render( scene, camera );
            }
            animate();

        </script>
    </div> 
</body>
</html>
